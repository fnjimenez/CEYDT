<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kahoot - Estudio del Trabajo</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Arial, sans-serif; }
        body { background: #46178f; color: #333; min-height: 100vh; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 15px; overflow: hidden; }
        
        /* Pantallas */
        .screen { display: none; }
        .active { display: block; }
        
        /* Login Screen */
        .login-screen { padding: 40px; text-align: center; background: #46178f; color: white; }
        .login-form { max-width: 400px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; color: #333; }
        .login-form input { width: 100%; padding: 12px; margin: 8px 0; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; }
        .login-form input:focus { border-color: #46178f; outline: none; }
        
        /* Moderador Screen */
        .moderator-screen { padding: 30px; text-align: center; }
        .game-code { font-size: 48px; font-weight: bold; color: #46178f; margin: 20px 0; letter-spacing: 5px; }
        .players-waiting { max-width: 600px; margin: 20px auto; }
        .player-card { display: inline-block; background: #f0f0f0; padding: 15px; margin: 10px; border-radius: 10px; text-align: center; min-width: 120px; }
        .player-avatar { width: 50px; height: 50px; border-radius: 50%; background: #ffcd00; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #46178f; }
        
        /* Game Screen */
        .game-screen {  }
        .header { background: #46178f; color: white; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; }
        .player-info { display: flex; align-items: center; gap: 10px; }
        .avatar { width: 40px; height: 40px; border-radius: 50%; background: #ffcd00; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #46178f; }
        .score-display { font-size: 18px; font-weight: bold; color: #ffcd00; }
        
        .question-container { padding: 30px; text-align: center; }
        .question-text { font-size: 24px; font-weight: bold; color: #333; margin-bottom: 20px; }
        
        .timer-bar { height: 8px; background: #ddd; margin: 15px 0; border-radius: 4px; overflow: hidden; }
        .timer-progress { height: 100%; background: #46178f; width: 100%; transition: width 1s linear; }
        
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; max-width: 800px; margin: 0 auto 20px; }
        .option { padding: 20px; border-radius: 10px; font-size: 16px; font-weight: bold; cursor: pointer; transition: all 0.3s; border: 3px solid transparent; color: white; text-align: center; }
        .option-a { background: #e74c3c; }
        .option-b { background: #3498db; }
        .option-c { background: #2ecc71; }
        .option-d { background: #f39c12; }
        .option:hover { transform: scale(1.05); }
        .option.selected { border-color: white; box-shadow: 0 0 10px rgba(255,255,255,0.5); }
        
        .btn { padding: 12px 30px; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; margin: 10px; background: #46178f; color: white; }
        .btn-success { background: #27ae60; }
        .btn-danger { background: #e74c3c; }
        .btn:disabled { background: #ccc; cursor: not-allowed; }
        
        .correct-answer { background: #27ae60 !important; }
        .incorrect-answer { background: #e74c3c !important; }
    </style>
</head>
<body>
    <div class="container">
        <!-- Pantalla de Login -->
        <div class="screen login-screen active" id="loginScreen">
            <h1>üéØ Kahoot - Estudio del Trabajo</h1>
            <p>Demuestra tus conocimientos y compite con tus compa√±eros</p>
            
            <div class="login-form">
                <h2>Unirse al Juego</h2>
                <input type="text" id="gameCodeInput" placeholder="C√≥digo del juego" value="KAH123">
                <input type="text" id="studentName" placeholder="Tu nombre completo" value="FAUSTO NOE JIMENEZ">
                <input type="text" id="studentId" placeholder="Matr√≠cula" value="1665">
                <button class="btn" onclick="joinAsStudent()" style="width: 100%; margin: 10px 0;">üéÆ UNIRSE AL JUEGO</button>
                <button class="btn btn-success" onclick="joinAsModerator()" style="width: 100%;">üë®‚Äçüè´ SOY EL MODERADOR</button>
            </div>
        </div>

        <!-- Pantalla de Moderador -->
        <div class="screen moderator-screen" id="moderatorScreen">
            <h1>üë®‚Äçüè´ Panel de Moderador</h1>
            <p>Comparte este c√≥digo con los estudiantes:</p>
            <div class="game-code" id="moderatorGameCode">KAH123</div>
            
            <div class="players-waiting">
                <h3>Jugadores en espera: <span id="playersCount">0</span></h3>
                <div id="playersList">
                    <!-- Jugadores aparecer√°n aqu√≠ -->
                </div>
            </div>
            
            <button class="btn btn-success" onclick="startGame()" id="startBtn">üéÆ INICIAR JUEGO</button>
            <button class="btn btn-danger" onclick="backToLogin()">‚Üê VOLVER</button>
        </div>

        <!-- Pantalla de Juego -->
        <div class="screen game-screen" id="gameScreen">
            <div class="header">
                <div class="player-info">
                    <div class="avatar" id="playerAvatar">F</div>
                    <div>
                        <div id="playerName">FAUSTO NOE JIMENEZ</div>
                        <div class="score-display" id="currentScore">0 puntos</div>
                    </div>
                </div>
                <div id="questionCounter">Pregunta 1/5</div>
            </div>

            <div class="question-container">
                <div class="question-text" id="questionText">¬øQu√© √°rea del IISE se enfoca en el dise√±o de estaciones de trabajo?</div>
                
                <div class="timer-bar">
                    <div class="timer-progress" id="timerProgress"></div>
                </div>

                <div class="options-grid">
                    <div class="option option-a" onclick="selectOption('a')">A) Facilities Engineering</div>
                    <div class="option option-b" onclick="selectOption('b')">B) Work Design & Measurement</div>
                    <div class="option option-c" onclick="selectOption('c')">C) Operations Research</div>
                    <div class="option option-d" onclick="selectOption('d')">D) Quality Engineering</div>
                </div>

                <button class="btn" id="submitBtn" onclick="submitAnswer()" disabled>Confirmar Respuesta</button>
            </div>
        </div>
    </div>

    <script>
        // Banco de preguntas
        const questionBank = [
            {
                question: "¬øQu√© √°rea del IISE se enfoca en el dise√±o de estaciones de trabajo?",
                options: ["Facilities Engineering", "Work Design & Measurement", "Operations Research", "Quality Engineering"],
                correct: "b",
                points: 100
            },
            {
                question: "¬øQui√©n es considerado el padre de la administraci√≥n cient√≠fica?",
                options: ["Henry Gantt", "Frederick Taylor", "Frank Gilbreth", "Henry Ford"],
                correct: "b", 
                points: 100
            },
            {
                question: "¬øQu√© representa el tiempo est√°ndar en estudio de tiempos?",
                options: ["Tiempo promedio", "Tiempo normal m√°s suplementos", "Tiempo m√°s r√°pido", "Tiempo m√°s lento"],
                correct: "b",
                points: 150
            },
            {
                question: "¬øQu√© t√©cnica usa c√≥digos predefinidos para analizar movimientos?",
                options: ["Diagrama de flujo", "Diagrama bimanual", "MTM", "Estudio de tiempos"],
                correct: "c",
                points: 150
            },
            {
                question: "¬øQu√© √°rea utiliza modelos matem√°ticos para optimizar sistemas?",
                options: ["Work Design", "Facilities Engineering", "Operations Research", "Engineering Economy"],
                correct: "c",
                points: 200
            }
        ];

        // Variables del juego
        let currentQuestion = 0;
        let score = 0;
        let selectedOption = null;
        let timeLeft = 30;
        let timerInterval;
        let questions = [];
        let isModerator = false;

        // Funci√≥n para unirse como estudiante
        function joinAsStudent() {
            const name = document.getElementById('studentName').value;
            const code = document.getElementById('gameCodeInput').value;
            
            if (!name || !code) {
                alert('Por favor ingresa tu nombre y el c√≥digo del juego');
                return;
            }
            
            document.getElementById('loginScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.add('active');
            document.getElementById('playerName').textContent = name;
            document.getElementById('playerAvatar').textContent = name.charAt(0).toUpperCase();
            
            // Iniciar juego demo
            questions = [...questionBank];
            loadQuestion();
        }

        // Funci√≥n para unirse como moderador
        function joinAsModerator() {
            isModerator = true;
            document.getElementById('loginScreen').classList.remove('active');
            document.getElementById('moderatorScreen').classList.add('active');
            
            // Generar c√≥digo de juego √∫nico
            const gameCode = 'KAH' + Math.floor(100 + Math.random() * 900);
            document.getElementById('moderatorGameCode').textContent = gameCode;
            
            // Simular jugadores conectados
            simulateConnectedPlayers();
        }

        // Simular jugadores conectados (para demo)
        function simulateConnectedPlayers() {
            const demoPlayers = [
                { name: 'MARIA GARCIA', avatar: 'M' },
                { name: 'CARLOS LOPEZ', avatar: 'C' },
                { name: 'ANA MARTINEZ', avatar: 'A' },
                { name: 'LUIS RODRIGUEZ', avatar: 'L' }
            ];
            
            const playersList = document.getElementById('playersList');
            const playersCount = document.getElementById('playersCount');
            
            playersList.innerHTML = '';
            demoPlayers.forEach(player => {
                const playerCard = document.createElement('div');
                playerCard.className = 'player-card';
                playerCard.innerHTML = `
                    <div class="player-avatar">${player.avatar}</div>
                    <div>${player.name}</div>
                `;
                playersList.appendChild(playerCard);
            });
            
            playersCount.textContent = demoPlayers.length;
        }

        // Funci√≥n para iniciar el juego (moderador)
        function startGame() {
            alert('¬°Juego iniciado! Todos los estudiantes comenzar√°n ahora.');
            // En una versi√≥n real, aqu√≠ se enviar√≠a una se√±al a todos los jugadores
            backToLogin();
        }

        // Volver al login
        function backToLogin() {
            document.getElementById('moderatorScreen').classList.remove('active');
            document.getElementById('gameScreen').classList.remove('active');
            document.getElementById('loginScreen').classList.add('active');
            isModerator = false;
        }

        // Funciones del juego
        function loadQuestion() {
            if (currentQuestion >= questions.length) {
                endGame();
                return;
            }

            const q = questions[currentQuestion];
            document.getElementById('questionText').textContent = q.question;
            document.getElementById('questionCounter').textContent = `Pregunta ${currentQuestion + 1}/${questions.length}`;

            const options = document.querySelectorAll('.option');
            options.forEach((opt, index) => {
                const letter = String.fromCharCode(97 + index);
                opt.textContent = `${letter.toUpperCase()}) ${q.options[index]}`;
                opt.className = `option option-${letter}`;
                opt.onclick = () => selectOption(letter);
                opt.style.pointerEvents = 'auto';
            });

            selectedOption = null;
            document.getElementById('submitBtn').disabled = true;
            resetTimer();
        }

        function selectOption(option) {
            selectedOption = option;
            document.getElementById('submitBtn').disabled = false;
            
            document.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            document.querySelector(`.option-${option}`).classList.add('selected');
        }

        function submitAnswer() {
            if (!selectedOption) return;

            const q = questions[currentQuestion];
            const isCorrect = selectedOption === q.correct;
            const optionElement = document.querySelector(`.option-${selectedOption}`);

            if (isCorrect) {
                score += q.points;
                optionElement.classList.add('correct-answer');
            } else {
                optionElement.classList.add('incorrect-answer');
                document.querySelector(`.option-${q.correct}`).classList.add('correct-answer');
            }

            document.getElementById('currentScore').textContent = `${score} puntos`;
            
            document.querySelectorAll('.option').forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            document.getElementById('submitBtn').disabled = true;

            setTimeout(() => {
                currentQuestion++;
                loadQuestion();
            }, 3000);
        }

        function resetTimer() {
            timeLeft = 30;
            clearInterval(timerInterval);
            
            const timerProgress = document.getElementById('timerProgress');
            timerProgress.style.width = '100%';
            timerProgress.style.background = '#46178f';
            
            timerInterval = setInterval(() => {
                timeLeft--;
                const progress = (timeLeft / 30) * 100;
                timerProgress.style.width = `${progress}%`;
                
                if (timeLeft <= 10) {
                    timerProgress.style.background = '#e74c3c';
                }
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    selectedOption = null;
                    submitAnswer();
                }
            }, 1000);
        }

        function endGame() {
            clearInterval(timerInterval);
            alert(`¬°Juego terminado! Puntuaci√≥n final: ${score} puntos\n¬°Excelente trabajo Fausto!`);
            // Reiniciar juego
            currentQuestion = 0;
            score = 0;
            backToLogin();
        }

        // Inicializar con datos de Fausto
        document.addEventListener('DOMContentLoaded', function() {
            console.log("Kahoot cargado - listo para usar");
        });
    </script>
</body>
</html>
